#### 了解动画

在本章中，你会学到:

•JavaFX中的动画是什么

关于JavaFX中用于执行动画的类

•如何执行时间轴动画，以及如何在时间轴上设置提示点

动画

•如何控制动画，如播放，反转，暂停和停止

•如何使用过渡执行动画

•关于不同类型的插值器和他们在动画中的角色



### What Is Animation?  

在现实世界中，动画意味着通过快速连续地显示图像而产生的某种运动。例如，当你看电影时，你正在观看图像，这些图像变化得如此之快，以至于你产生了一种运动的错觉。

在JavaFX中，动画被定义为随着时间改变一个节点的属性。如果改变的属性决定了节点的位置，那么JavaFX中的动画将产生一种在电影中发现的运动错觉。不是所有的动画都需要有动作;例如，随着时间的推移改变形状的填充属性是JavaFX中不涉及运动的动画。

为了理解动画是如何执行的，理解一些关键概念是很重要的。

•	 Timeline(时间轴)
•	 Key frame(关键帧)
•	 Key value(键值)
•	 Interpolator  (插入器)

动画是在一段时间内完成的。Timeline 表示动画在给定时刻与相关关键帧之间的时间进展。Key frame表示在时间轴上的特定时刻动画节点的状态。Key value具有关联的键值。键值表示节点的属性值以及要使用的Interpolator  。

假设你想在10秒内将一个圆从左向右水平移动。图22-1显示了在某些位置的圆… 粗的水平线表示时间线。带实心轮廓的圆圈表示时间轴上特定瞬间的关键帧。与关键帧相关联的关键值显示在顶部一行。例如，第5秒关键帧的圆圈的translateX属性值为500，如图tx=500所示。

![image-20200923122253472](image-20200923122253472.png)

开发人员提供时间线、关键帧和关键值。在这个例子中，有五个关键帧。如果JavaFX只在5个相应的瞬间显示5个关键帧，那么动画看起来会很不稳定。为了提供一个平滑的动画，JavaFX需要在时间轴上的任何瞬间插入圆的位置。也就是说，JavaFX需要在两个连续提供的关键帧之间创建中间关键帧。JavaFX在一个插值器的帮助下做到了这一点。默认情况下，它使用一个线性插值器，它会随着时间线性地改变动画属性。也就是说，如果时间轴上的时间超过了x%，则该属性的值在初始目标值和最终目标值之间为x%。带有虚线轮廓的圆圈是由JavaFX使用插值器创建的。

### Understating Animation Classes  

![image-20200923122534786](image-20200923122534786.png)

抽象的Animation类表示一个动画。它包含所有类型动画使用的通用属性和方法。

JavaFX支持两种动画类型。

•Timeline animations   时间轴动画

•Transitions   转换

在时间轴动画中，创建时间轴并向其添加关键帧。JavaFX使用插值器创建中间关键帧。Timeline类的实例表示一个Timeline动画。这种类型的动画需要更多的代码，但是它提供了更多的控制。

通常会执行几种类型的动画(沿着路径移动一个节点，随着时间改变一个节点的不透明度，等等)。这些类型的动画称为过渡。它们是使用内部时间线执行的。转换类的实例表示一个转换动画。转换类的几个子类支持特定类型的转换。例如，FadeTransition类通过随时间改变节点的不透明度来实现衰落效果动画。您可以创建转换类的实例(通常是它的一个子类的实例)，指定动画属性的初始值和最终值以及动画的持续时间。JavaFX负责创建时间轴和执行动画。这种类型的动画更容易使用。

有时，您可能希望连续或同时执行多个转换。SequentialTransition和ParallelTransition类让您分别顺序地和同时地执行一组转换。

### Understanding Utility Classes  

在讨论JavaFX动画的细节之前，我将讨论一些用于实现动画的实用程序类。下面几节将讨论这些类。

Understanding the Duration Class  

Duration类在javafx.util包。它以毫秒、秒、分钟和小时为单位表示一段时间。它是一个不可变类。持续时间表示动画的每个周期所需的时间。持续时间可以表示正的或负的持续时间

创建Duration对象有三种方法

•使用构造函数

•使用工厂方法

•使用字符串格式的持续时间中的valueOf()方法

构造函数花费的时间以毫秒为单位。  Duration tenMillis = new Duration(10);  

工厂方法为不同的时间单位创建Duration对象。它们是millis()、seconds()、minutes()和hours()。

Duration tenMillis = Duration.millis(10);
Duration tenSeconds = Duration.seconds(10);
Duration tenMinutes = Duration.minutes(10);
Duration tenHours = Duration.hours(10) ;

valueOf()静态方法接受一个包含持续时间的字符串参数，并返回一个持续时间对象。参数的格式为“number[ms|s|m|h]”，其中number为时间量，ms、s、m、h分别表示毫秒、秒、分钟、小时。

Duration tenMillis = Duration.valueOf("10.0ms");
Duration tenMililsNeg = Duration.valueOf("-10.0ms");  

还可以分别使用duration类的unknown和不定常数表示未知时间长度和不定时间长度。可以使用isIndefinite()和isUnknown()方法检查持续时间是否表示不确定的或未知的时间。这个类还声明了两个常数，1和0，分别表示持续时间为1毫秒和0(没有时间)

Duration类提供了几种操作持续时间的方法(将一个持续时间添加到另一个持续时间中，将一个持续时间除以一个数字，比较两个持续时间，等等)。清单22-1显示了如何使用Duration类。

