### 光复唐氏

1.  在自己帮派的npc处接取. (需要判断 接取任务的时候 是否在自己帮派中)
2. ![image-20200924151926052](image-20200924151926052.png)

3. 接取成功后

![image-20200924155559329](image-20200924155559329.png)



​	4. 根据配置的数量随机任务,  根据任务类型设置 任务状态(杀怪任务设置为 **未接取**, 读条后开始倒计时,   其他设置成已经接取)

![image-20200924155613492](image-20200924155613492.png)



5. 发送界面数据.  分为助人的界面, 还是自己的界面

   自己的界面

![image-20200924160332117](image-20200924160332117.png)



​	求助的界面

![image-20200924160350973](image-20200924160350973.png)





6. **次数刷新是走 活动的重置**

![image-20200924170321358](image-20200924170321358.png)





7. 杀怪任务, 开始的时候是未接取, 当点击埋伏的时候, 任务开始.  倒计时也开始.  此时客户端发送的是开始读条请求, 可以查看GuildTransportTask.xlsx中的配置

   ​	代码快速查看(CommonStripeTypeEnum类的枚举)

![image-20200924171043221](image-20200924171043221.png)



![image-20200924173511028](image-20200924173511028.png)





刷新出的怪物npc 为  **GuildTransportNpc.class** 查看里面的方法

![image-20200925115458442](image-20200925115458442.png)

以及添加到场景上面的方法

![image-20200925115521438](image-20200925115521438.png)

如果是杀怪的任务,  刷完怪, 才会设置超时时间(由npc配置  getKeepTime() 控制)

```java
ActorGuildTransportTask transportTask = actorGuildTransport.getTasks().get(transportTaskId);
transportTask.setStatus(GuildTransportTaskStatusEnum.ACCEPTED.getValue());
transportTask.setExpireTime(getNowTickTime() + guildTransportNpc.getExistTime());
transportTask.setKillNpcSceneId(guildTransportNpc.getScene().getSceneID());
transportTask.setKillNpcLineId(guildTransportNpc.getScene().getLineID());
transportTask.setKillNpcObjectId(guildTransportNpc.getObjectID());

taskUpdateNotice(transportTask);
```





货运任务提交. 也分为自己的和其他人的

![image-20200924173548316](image-20200924173548316.png)



活动结束会重置求助次数, 并且clear 生成的Task集合

![image-20200927103301835](image-20200927103301835.png)





10. 帮派货运求助,  对话和小游戏不允许求助.  同帮派的才可以求助

    ![image-20200927103622421](image-20200927103622421.png)

    

11. 